[gd_scene load_steps=21 format=3 uid="uid://cilul41id8eno"]

[ext_resource type="Script" uid="uid://b0er2tvfh44gs" path="res://enemy/enemy.gd" id="1_2mvqj"]
[ext_resource type="Script" uid="uid://bgcqn6tjnhu6h" path="res://addons/LineRenderer/line_renderer.gd" id="2_1wwld"]
[ext_resource type="PackedScene" uid="uid://cidcc427dt3j2" path="res://enemy/enemy_shot/enemy_shot.tscn" id="2_o3pv7"]
[ext_resource type="PackedScene" uid="uid://cuyv7nb4q6ra1" path="res://enemy/stickman.glb" id="2_ofsxj"]
[ext_resource type="Shader" uid="uid://bmuek6vsl4cap" path="res://Line.gdshader" id="3_6yflr"]
[ext_resource type="PackedScene" uid="uid://srsx0nh1y4bg" path="res://gun/revolver.glb" id="3_ppra6"]
[ext_resource type="Shader" uid="uid://dv311u4lvjngq" path="res://enemy/shaders/StickmanBody.gdshader" id="4_78jik"]
[ext_resource type="Texture2D" uid="uid://drmr4722ydefw" path="res://dotted.png" id="4_gf88j"]
[ext_resource type="PackedScene" uid="uid://84qjmolqrdxk" path="res://enemy/cowboyjacket.glb" id="4_p200p"]
[ext_resource type="Shader" uid="uid://cuvte6qy7dx3v" path="res://enemy/shaders/StickmanHed.gdshader" id="5_o3pv7"]
[ext_resource type="PackedScene" uid="uid://eli3k4g665tk" path="res://enemy/hat.glb" id="5_pmsee"]
[ext_resource type="Script" uid="uid://7sp71apr4hr2" path="res://shot/hitbox/hitbox.gd" id="7_y5vj3"]
[ext_resource type="AudioStream" uid="uid://cqjyyqwhv0jfd" path="res://sounds/shoot.ogg" id="8_5ffra"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_scxef"]
radius = 0.3
height = 1.8

[sub_resource type="Curve3D" id="Curve3D_2mvqj"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_tbw0t"]
render_priority = 0
shader = ExtResource("3_6yflr")
shader_parameter/tex = ExtResource("4_gf88j")
shader_parameter/color = Color(0.847087, 0.505191, 0.227849, 1)

[sub_resource type="ImmediateMesh" id="ImmediateMesh_6yflr"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_6yflr"]
render_priority = 0
shader = ExtResource("4_78jik")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_gf88j"]
render_priority = 0
shader = ExtResource("5_o3pv7")

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_e355f"]
radius = 0.3
height = 1.8

[node name="Enemy" type="CharacterBody3D" node_paths=PackedStringArray("hitbox", "gun", "animation_player", "nav_agent", "path_3d", "path_follow", "line_renderer", "shoot_player", "visible_notifier") groups=["enemy"]]
collision_layer = 4
script = ExtResource("1_2mvqj")
hitbox = NodePath("Hitbox")
gun = NodePath("stickman/rig/Skeleton3D/HandAttachment/revolver2")
animation_player = NodePath("stickman/AnimationPlayer")
nav_agent = NodePath("NavigationAgent3D")
path_3d = NodePath("Path3D")
path_follow = NodePath("Path3D/PathFollow3D")
line_renderer = NodePath("Path3D/LineRenderer3D")
shoot_player = NodePath("ShootPlayer")
enemy_shot_scene = ExtResource("2_o3pv7")
visible_notifier = NodePath("VisibleOnScreenNotifier3D")

[node name="VisibleOnScreenNotifier3D" type="VisibleOnScreenNotifier3D" parent="."]
aabb = AABB(-0.315, -0.01, -1, 0.62, 1.875, 2)

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9, 0)
shape = SubResource("CapsuleShape3D_scxef")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]

[node name="Path3D" type="Path3D" parent="."]
top_level = true
curve = SubResource("Curve3D_2mvqj")

[node name="PathFollow3D" type="PathFollow3D" parent="Path3D"]

[node name="LineRenderer3D" type="MeshInstance3D" parent="Path3D"]
material_override = SubResource("ShaderMaterial_tbw0t")
mesh = SubResource("ImmediateMesh_6yflr")
script = ExtResource("2_1wwld")
start_thickness = 0.4
end_thickness = 0.4
metadata/_custom_type_script = "uid://bgcqn6tjnhu6h"

[node name="stickman" parent="." instance=ExtResource("2_ofsxj")]
transform = Transform3D(-1, 0, 8.74228e-08, 0, 1, 0, -8.74228e-08, 0, -1, 0, 0, 0)

[node name="Circle" parent="stickman/rig/Skeleton3D" index="0"]
lod_bias = 128.0
surface_material_override/0 = SubResource("ShaderMaterial_6yflr")
surface_material_override/1 = SubResource("ShaderMaterial_gf88j")

[node name="HandAttachment" type="BoneAttachment3D" parent="stickman/rig/Skeleton3D" index="1"]
transform = Transform3D(-0.0693201, -0.991522, 0.109903, 0.988366, -0.0832108, -0.127309, 0.135375, 0.0997994, 0.985756, -0.692153, 1.33295, -0.00654114)
bone_name = "DEF-hand.R"
bone_idx = 174

[node name="revolver2" parent="stickman/rig/Skeleton3D/HandAttachment" instance=ExtResource("3_ppra6")]
transform = Transform3D(-0.0145276, 0.0198379, 0.999697, 0.970766, 0.239848, 0.00934753, -0.23959, 0.970608, -0.0227423, 0.012982, 0.129356, 0.0916709)

[node name="TorsoAttachment" type="BoneAttachment3D" parent="stickman/rig/Skeleton3D" index="2"]
transform = Transform3D(1, 1.42109e-14, 2.38419e-07, 1.1546e-07, 0.874915, -0.484276, -2.08596e-07, 0.484275, 0.874916, 0, 1.37236, -0.00943485)
bone_name = "DEF-spine.004"
bone_idx = 5

[node name="cowboyjacket2" parent="stickman/rig/Skeleton3D/TorsoAttachment" instance=ExtResource("4_p200p")]
transform = Transform3D(-0.0396919, 0.000413286, -0.999212, 0.470384, 0.882272, -0.0183203, 0.881569, -0.470741, -0.0352135, -0.0140792, -0.206312, 0.116019)

[node name="HeadAttachment" type="BoneAttachment3D" parent="stickman/rig/Skeleton3D" index="3"]
transform = Transform3D(1, -1.42109e-13, 2.38419e-07, 3.22409e-13, 1, -5.96046e-07, -2.38419e-07, 4.17233e-07, 1, 4.86309e-16, 1.42919, 0.0204423)
bone_name = "DEF-spine.006"
bone_idx = 7

[node name="hat" parent="stickman/rig/Skeleton3D/HeadAttachment" instance=ExtResource("5_pmsee")]
transform = Transform3D(-4.37114e-08, 3.38813e-21, 1, 0, 1, -3.38813e-21, -1, 0, -4.37114e-08, -4.88498e-15, 0.334602, 9.31323e-09)

[node name="Hitbox" type="Area3D" parent="."]
script = ExtResource("7_y5vj3")
metadata/_custom_type_script = "uid://7sp71apr4hr2"

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9, 0)
shape = SubResource("CapsuleShape3D_e355f")

[node name="ShootPlayer" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("8_5ffra")

[connection signal="got_hit" from="Hitbox" to="." method="_on_hitbox_got_hit"]

[editable path="stickman"]
